window.__require=function e(t,n,i){function s(o,a){if(!n[o]){if(!t[o]){var c=o.split("/");if(c=c[c.length-1],!t[c]){var h="function"==typeof __require&&__require;if(!a&&h)return h(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+o+"'")}}var v=n[o]={exports:{}};t[o][0].call(v.exports,function(e){return s(t[o][1][e]||e)},v,v.exports,e,t,n,i)}return n[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(e){return"function"==typeof e}function r(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!r(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,r,c,h;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var v=new Error('Uncaught, unspecified "error" event. ('+t+")");throw v.context=t,v}if(a(n=this._events[e]))return!1;if(s(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(o(n))for(r=Array.prototype.slice.call(arguments,1),i=(h=n.slice()).length,c=0;c<i;c++)h[c].apply(this,r);return!0},i.prototype.addListener=function(e,t){var n;if(!s(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,s(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){if(!s(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var n,i,r,a;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(n=this._events[e]).length,i=-1,n===t||s(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=r;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?s(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(s(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],eventCode:[function(e,t,n){"use strict";cc._RF.push(t,"4bac2rxuiVAOLbF1z9vmn3H","eventCode");t.exports={PLAY:"PLAY",JUMP:"JUMP",JUMPBACK:"JUMPBACK",WIN:"WIN",WALK:"WALK",RUN:"RUN",RUNBACK:"RUNBACK",SHOOT:"SHOOT",AIM:"AIM",DELETE:"DELETE",DEATH:"DEATH",GAMEOVER:"GAMEOVER"},cc._RF.pop()},{}],keyController:[function(e,t,n){"use strict";cc._RF.push(t,"853787wa3RP9aPUiwzIwnHf","keyController"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],mEmitter:[function(e,t,n){"use strict";cc._RF.push(t,"6df42pFNGZItYQPDj21NIEm","mEmitter");var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=e("events"),o=function(){function e(){s(this,e),this._emiter=new r,this._emiter.setMaxListeners(100)}return i(e,[{key:"emit",value:function(){var e;(e=this._emiter).emit.apply(e,arguments)}},{key:"registerEvent",value:function(e,t){this._emiter.on(e,t)}},{key:"registerOnce",value:function(e,t){this._emiter.once(e,t)}},{key:"removeEvent",value:function(e,t){this._emiter.removeListener(e,t)}},{key:"destroy",value:function(){this._emiter.removeAllListeners(),this._emiter=null,e.instance=null}}]),e}();o.instance=null==o.instance?new o:o.instance,t.exports=o,cc._RF.pop()},{events:1}],mainController:[function(e,t,n){"use strict";cc._RF.push(t,"fc9a3IY9cdM7plni190I8uM","mainController");var i=e("mEmitter"),s=e("eventCode");cc.Class({extends:cc.Component,properties:{monster:cc.Node,fence:cc.Node,avatar:sp.Skeleton,gate:cc.Node,btnPlay:cc.Button,btnResetGame:cc.Button,winText:cc.RichText,scoreText:cc.Label,_flag:!0,_posPlayer:"",_accMonster:""},onLoad:function(){cc.log("controller"),this.node.on("mousedown",this.registerPlay,this),this._btnPlayGame=this.playGame.bind(this),this._gameOver=this.gameOver.bind(this),this._gameWin=this.gameWin.bind(this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),i.instance.registerEvent(s.DEATH,this._gameOver)},registerPlay:function(){i.instance.registerEvent(s.PLAY,this._btnPlayGame)},playGame:function(){this.monster.active=!0,this.fence.active=!0,this.gate.active=!0,this.avatar.node.active=!0,this.btnPlay.node.active=!1,this.scoreText.node.active=!0,this.moveMonster(),this.score=0},onKeyDown:function(e){switch(e.keyCode){case 37:this._flag||(this._flag=!0,i.instance.emit(s.RUNBACK,!0));break;case 39:this._flag||(this._flag=!0,i.instance.emit(s.RUN,!0));break;case 38:this._flag||(this._flag=!0,i.instance.emit(s.JUMP,!0));break;case 40:this._flag||(this._flag=!0,i.instance.emit(s.JUMPBACK,!0));break;case 32:this._flag||(this._flag=!0,i.instance.emit(s.SHOOT,!0))}},onKeyUp:function(e){switch(e.keyCode){case 37:this._flag=!1,i.instance.emit(s.RUNBACK,!1);break;case 39:this._flag=!1,i.instance.emit(s.RUN,!1);break;case 38:this._flag=!1,i.instance.emit(s.JUMP,!1);break;case 40:this._flag=!1,i.instance.emit(s.JUMPBACK,!1);break;case 32:this._flag=!1,i.instance.emit(s.SHOOT,!1)}},moveMonster:function(){var e=cc.moveBy(.8,cc.v2(50,0)),t=cc.moveBy(.8,cc.v2(-50,0));this._accMonster=cc.repeatForever(cc.sequence(e,t)),this.monster.runAction(this._accMonster)},gameOver:function(){var e=this;this.avatar.setAnimation(0,"death",!0),this.avatar.setCompleteListener(function(){e.avatar.clearTracks(),e.avatar.setToSetupPose()}),i.instance.emit(s.GAMEOVER,!0),this.avatar.node.destroy(),this.gate.destroy(),this.fence.destroy(),this.monster.destroy()},gameWin:function(){var e=this;this.avatar.setAnimation(0,"hoverboard",!0),this.avatar.setCompleteListener(function(){e.avatar.clearTracks(),e.avatar.setToSetupPose(),e.avatar.setAnimation(0,"hoverboard",!0)}),this.winText.node.active=!0},checkWin:function(){var e=this.avatar.node.getPosition();return this.gate.position.sub(e).mag()},update:function(e){this.checkWin()<130?this.gameWin():this.gainScore(e)},gainScore:function(e){1==this._flag?(this.score=this.score+e,this.scoreText.string="Score:"+this.score):this.scoreText.string="Score:"+this.score},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)}}),cc._RF.pop()},{eventCode:"eventCode",mEmitter:"mEmitter"}],move:[function(e,t,n){"use strict";cc._RF.push(t,"4221d5sCm1IzKLdw0/IrRYS","move");var i=e("mEmitter"),s=e("eventCode");cc.Class({extends:cc.Component,properties:{avatar:sp.Skeleton,bullet:cc.Prefab,_flag:!0,jumpAudio:{default:null,type:cc.AudioClip},_action:""},onCollisionEnter:function(e,t){1==e.tag&&i.instance.emit(s.DEATH,!0),2==e.tag&&i.instance.emit(s.DEATH,!0)},onLoad:function(){this._runBack=this.runBack.bind(this),this._runTo=this.runTo.bind(this),this._jumpTo=this.jumpTo.bind(this),this._jumpBack=this.jumpBack.bind(this),this._shoot=this.shoot.bind(this),this._gameover=this.gameover.bind(this),i.instance.registerEvent(s.RUNBACK,this._runBack),i.instance.registerEvent(s.RUN,this._runTo),i.instance.registerEvent(s.JUMP,this._jumpTo),i.instance.registerEvent(s.JUMPBACK,this._jumpBack),i.instance.registerEvent(s.SHOOT,this._shoot),i.instance.registerEvent(s.GAMEOVER,this._gameover),cc.director.getCollisionManager().enabled=!0},playJumpSound:function(){cc.audioEngine.playEffect(this.jumpAudio,!1)},goStraight:function(){this.avatar.setAnimation(0,"walk",!1);var e=cc.spawn(cc.flipX(),cc.moveTo(.9,cc.v2(this.avatar.node.x+50,this.avatar.node.y)));this._action=this.avatar.node.runAction(e),this.resetPose()},goBack:function(){this.avatar.setAnimation(0,"walk",!1);var e=cc.spawn(cc.flipX(-1),cc.moveTo(.9,cc.v2(this.avatar.node.x-50,this.avatar.node.y)));this._action=this.avatar.node.runAction(e),this.resetPose()},runTo:function(e){if(e){this.avatar.clearTracks(),this.avatar.setAnimation(0,"run",!1);var t=cc.spawn(cc.flipX(),cc.moveBy(.9,100,0));this._action=this.avatar.node.runAction(t),this.resetPose()}else this.goStraight()},runBack:function(e){if(e){this.avatar.setAnimation(0,"run",!1);var t=cc.spawn(cc.flipX(-1),cc.moveBy(.9,cc.v2(-100,0)));this._action=this.avatar.node.runAction(t),this.resetPose()}else this.goBack()},jumpTo:function(e){if(e){this.avatar.setAnimation(0,"jump",!1);var t=cc.callFunc(this.playJumpSound,this),n=cc.moveBy(.8,100,0),i=cc.moveBy(.4,cc.v2(0,50)).easing(cc.easeCubicActionOut()),s=cc.moveBy(.4,cc.v2(0,-50)).easing(cc.easeCubicActionIn()),r=cc.spawn(cc.flipX(),n,cc.sequence(i,s),t);this._action=this.avatar.node.runAction(r),this.resetPose()}},jumpBack:function(e){if(e){this.avatar.setAnimation(0,"jump",!1);var t=cc.callFunc(this.playJumpSound,this),n=cc.moveBy(.8,-100,0),i=cc.moveBy(.4,cc.v2(0,50)).easing(cc.easeCubicActionOut()),s=cc.moveBy(.4,cc.v2(0,-50)).easing(cc.easeCubicActionIn()),r=cc.spawn(cc.flipX(-1),n,cc.sequence(i,s),t);this._action=this.avatar.node.runAction(r),this.resetPose()}},shoot:function(e){e&&(this.avatar.setAnimation(0,"aim",!1),this.avatar.setAnimation(1,"shoot",!1),this.createBullet(),this.resetPose())},resetPose:function(){var e=this;this.avatar.setCompleteListener(function(){e.avatar.clearTracks(),e.avatar.setToSetupPose(),e.avatar.setAnimation(0,"idle",!0)})},gameover:function(){},createBullet:function(){var e=cc.instantiate(this.bullet);if(this.avatar.node.scaleX>0){e.parent=this.node.parent,e.x=this.avatar.node.x+80,e.y=this.avatar.node.y+50;var t=cc.moveBy(.2,cc.v2(2e3,0)),n=cc.callFunc(function(){e.destroy()},this),i=cc.sequence(t,n);e.runAction(i)}else{e.parent=this.node.parent,e.x=this.avatar.node.x-180,e.y=this.avatar.node.y+50;var s=cc.spawn(cc.flipX(),cc.moveBy(.2,cc.v2(-2e3,0))),r=cc.callFunc(function(){e.destroy()},this),o=cc.sequence(s,r);e.runAction(o)}}}),cc._RF.pop()},{eventCode:"eventCode",mEmitter:"mEmitter"}],playGame:[function(e,t,n){"use strict";cc._RF.push(t,"4355a0oWrNHhKifAoKAePsl","playGame");var i=e("mEmitter"),s=e("eventCode");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){},onplay:function(){i.instance.emit(s.PLAY,"play game")}}),cc._RF.pop()},{eventCode:"eventCode",mEmitter:"mEmitter"}],resetGame:[function(e,t,n){"use strict";cc._RF.push(t,"67a27eaO7BJFJu1W/il+Cae","resetGame"),cc.Class({extends:cc.Component,properties:{},onResetGame:function(){Emitter.instance.emit(eventCode.RESETGAME,!0)},start:function(){}}),cc._RF.pop()},{}]},{},["eventCode","keyController","mEmitter","mainController","move","playGame","resetGame"]);